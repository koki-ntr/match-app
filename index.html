<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>研究室診断</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 0;
        }

        p{
            text-align: center;
        }

        .container {
            width: 80%;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        h1{text-align: center;}

        .h{position:relative;
            top: 5px;}

        h1,h2 {
            color: #333;
        }

        .question {
            margin-bottom: 20px;
        }


        .label1 { 
            display: block;
            margin: 10px 0;
            width: 98%;
            max-width: 900px;
            height: 55px;
            padding-left: 5px;
            padding-right: 5px;
            text-align: center;
            cursor: pointer;
            border-radius: 50px;
            line-height: 55px;
            background-color: #e3364a;
            box-shadow: 0 5px 0#ca1c30;
            color: #ffffff;
            transition: .3s;
        }

        label:hover{
            box-shadow: none;
            transform: translateY(5px);
        }

        input[type=radio]{
            display: none;
        }

        input[type="radio"]:checked + label{
            background: #31a9ee;
            box-shadow: 0 5px 0#0088aa;
            color: #ffffff;
            transition: .3s;
        }

        input[type="radio"]:checked + label:hover{
            box-shadow: none;
            transform: translateY(5px);
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: .3s;
        }

        button:hover {
            background-color: #227722;
        }

        #result {
            margin-top: 30px;
        }

        .hidden {
            display: none;
        }

        .result-item {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 8px;
        }

        .result-item h3 {
            margin: 0;
            color: #4CAF50;
        }

        .result-item p {
            margin: 5px 0;
        }

        .result-item .match {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><img src="ハート.png" widhth=30 height=30 class="h">研究室診断<img src="ハート.png" widhth=30 height=30 class="h"></h1>
        <p><img src="ハート.png" widhth=20 height=20 class="h">質問に答えるだけで、あなたにピッタリの研究室を探し出します！！！！！！！！！！！<img src="ハート.png" widhth=20 height=20 class="h"></p>
        <p><対象研究室></p>
        <p>板井研究室、宇佐美研究室、奥居研究室、木村研究室、中村研究室、山内研究室、山下研究室、山本研究室</p>
        <form id="questionForm">
            <div class="question">
                <h2>1. 研究分野</h2>
                <input type="radio" name="field" value="1" id="11"> <label for="11" class="label1">情報通信</label>
                <input type="radio" name="field" value="2" id="12"> <label for="12" class="label1">メディア情報</label>
                <input type="radio" name="field" value="3" id="13"> <label for="13" class="label1">知能情報</label>
                <input type="radio" name="field" value="4" id="14"> <label for="14" class="label1">計算・アルゴリズム</label>
            </div>
            <!-- 他の質問も同様にここに追加 -->
            
            <div class="question">
                <h2>2. 研究スタイル</h2>
                <input type="radio" name="style" value="1" id="21"><label for="21" class="label1">個人研究中心</label>
                <input type="radio" name="style" value="2" id="22"><label for="22" class="label1">グループ研究中心</label>
                <input type="radio" name="style" value="3" id="23"><label for="23" class="label1">バランス型</label>
            </div>

            <div class="question">
                <h2>3. 研究室の雰囲気</h2>
                <input type="radio" name="atomsphere" value="1" id="31"><label for="31" class="label1">静かで落ち着いている</label>
                <input type="radio" name="atomsphere" value="2" id="32"><label for="32" class="label1">活発でにぎやか</label>
            </div>

            <!--<div class="question">
                <h2>4. 指導スタイル</h2>
                <input type="radio" name="style2" value="1" id="41"><label for="41" class="label1">自由性重視</label>
                <input type="radio" name="style2" value="2" id="42"><label for="42" class="label1">定期的なフォロー・チェック型</label>
                <input type="radio" name="style2" value="3" id="43"><label for="43" class="label1">厳密なスケジュール管理</label>
            </div>-->

            <div class="question">
                <h2>4. 研究の進め方</h2>
                <input type="radio" name="support" value="1" id="51"><label for="51" class="label1">自由性重視</label>
                <input type="radio" name="support" value="2" id="52"><label for="52" class="label1">定期的なフォロー・チェック型</label>
                <input type="radio" name="support" value="3" id="53"><label for="53" class="label1">厳しいスケジュール管理</label>
            </div>

            <div class="question">
                <h2>5. 研究の楽しさ・やりがい</h2>
                <input type="radio" name="enjoy" value="1" id="61"><label for="61" class="label1">大いに求める</label>
                <input type="radio" name="enjoy" value="2" id="62"><label for="62" class="label1">やや求める</label>
                <input type="radio" name="enjoy" value="3" id="63"><label for="63" class="label1">気にしない</label>
            </div>

            <div class="question">
                <h2>6. 研究室の負担の少なさ</h2>
                <input type="radio" name="burden" value="1" id="71"><label for="71" class="label1">大いに求める</label>
                <input type="radio" name="burden" value="2" id="72"><label for="72" class="label1">やや求める</label>
                <input type="radio" name="burden" value="3" id="73"><label for="73" class="label1">気にしない</label>
            </div>

            <div class="question">
                <h2>7. 他の活動との両立のしやすさ</h2>
                <input type="radio" name="activ" value="1" id="81"><label for="81" class="label1">大いに求める</label>
                <input type="radio" name="activ" value="2" id="82"><label for="82" class="label1">やや求める</label>
                <input type="radio" name="activ" value="3" id="83"><label for="83" class="label1">気にしない</label>
            </div>
    
            <button type="button" id="matchButton">マッチング開始</button>
        </form>

        <div id="result" class="hidden">
            <h2>上位3つの研究室</h2>
            <div id="resultList"></div>
        </div>
    </div>

    <script>
        document.getElementById("matchButton").addEventListener("click", function() {

// ユーザーの回答を取得
const userResponses = {
    field: getSelectedValue_radio("field"),
    style: getSelectedValue_radio("style"),
    atomsphere: getSelectedValue_radio("atomsphere"),
    support: getSelectedValue_radio("support"),
    enjoy: getSelectedValue_radio("enjoy"),
    burden: getSelectedValue_radio("burden"),
    activ: getSelectedValue_radio("activ")
};

 // 未選択チェック
 for (const key in userResponses) {
  if (userResponses[key] === null) {
      alert("すべての質問に回答してください！");
      return;
  }
}

// マッチング処理
const results = matchResearchLabs(userResponses, researchLabs, maxValues);

displayResults(results);
});


// ユーザーが選んだラジオボタンの値を取得する関数
function getSelectedValue_radio(name) {
const selected = document.querySelector(`input[name="${name}"]:checked`);
return selected ? parseInt(selected.value) : null; // 数値に変換し、未選択時には null を返す
}


// 研究室データ
const researchLabs = [
//{ name: "", field: , style: , atomsphere: , skill: , pace: , enjoy: , burden: },
{ name: "板井研究室", field: 2.0, style: 1.6, atomsphere: 1.4, support: 1.9, enjoy: 2.4, burden: 2.3, activ: 2.1, url: "https://www.chubu.ac.jp/academics/engineering/computer-science/laboratory/labo15/"},
{ name: "宇佐美研究室", field: 1.0, style: 1.7, atomsphere: 1.6, support: 1.5, enjoy: 2.5, burden: 2.0, activ: 2.7, url: "https://research-db.chubu.ac.jp/chbhp/KgApp/k03/resid/S002362?lang=ja"},
{ name: "木村研究室", field: 1.0, style: 1.7, atomsphere: 1.8, support: 1.8, enjoy: 2.2, burden: 2.0, activ: 2.3, url: "https://www.chubu.ac.jp/academics/engineering/computer-science/laboratory/labo2/"},
{ name: "奥居研究室", field: 4.0, style: 1.0, atomsphere: 1.5, support: 1.5, enjoy: 1.8, burden: 2.5, activ: 2.5, url: "https://www.chubu.ac.jp/academics/engineering/computer-science/laboratory/labo11/"},
{ name: "中村研究室", field: 3.0, style: 1.2, atomsphere: 1.5, support: 1.6, enjoy: 2.4, burden: 1.7, activ: 3.0, url: "https://www.chubu.ac.jp/chubuly-style/3989/"},
{ name: "山内研究室", field: 3.0, style: 2.75, atomsphere: 1.5, support: 1.3, enjoy: 2.5, burden: 2.0, activ: 2.3, url: "https://www.chubu.ac.jp/academics/engineering/computer-science/laboratory/labo9/"},
{ name: "山下研究室", field: 3.0, style: 1.6, atomsphere: 1.6, support: 1.7, enjoy: 2.5, burden: 2.0, activ: 1.7, url: "https://www.chubu.ac.jp/academics/engineering/computer-science/laboratory/labo17/"},
{ name: "山本研究室", field: 2.0, style: 1.0, atomsphere: 1.0, support: 1.8, enjoy: 2.4, burden: 2.1, activ: 2.1, url: "https://www.chubu.ac.jp/academics/engineering/computer-science/laboratory/labo19/"}
];

// 最大距離
const maxValues = { 
field: 3, 
style: 2, 
atomsphere: 1, 
support: 2, 
enjoy: 2, 
burden: 2, 
activ: 2
};


// マッチング処理
function matchResearchLabs(userResponses, researchLabs, maxValues) {

// 各研究室との一致度を計算
const results = researchLabs.map((lab) => {
  let score = 0;
  let maxScore = 0;

  // スコア計算（ユーザーとの距離）
  for (let key in userResponses) {
      let weight = 1.0; // 初期値を設定

      // 質問項目に応じて重みを設定
      if (key === "enjoy" || key === "activ") {
          if (userResponses[key] === 1) {
              weight = 1.0;
          } else if (userResponses[key] === 2) {
              weight = 0.5;
          } else {
              weight = 0.0;
          }

          // 距離計算（楽しさ・やりがい、両立項目）
          score += weight * Math.pow(3 - lab[key], 2);  // lab[key]は対応する研究室のデータ
          maxScore += weight * Math.pow(maxValues[key], 2);  // maxValues[key]は最大値
      } 
      else if (key === "burden") {
          if (userResponses[key] === 1) {
              weight = 1.0;
          } else if (userResponses[key] === 2) {
              weight = 0.5;
          } else {
              weight = 0.0;
          }

          // 距離計算（負担項目）
          score += weight * Math.pow(1 - lab[key], 2);
          maxScore += weight * Math.pow(maxValues[key], 2);
      }
      else {
          // その他の質問項目の距離計算
          score += Math.pow(userResponses[key] - lab[key], 2);
          maxScore += Math.pow(maxValues[key], 2);  // maxValuesの範囲で計算
      }
  }

  // 距離を平方根で計算
  const scoreR = Math.sqrt(score);
  const maxScoreR = Math.sqrt(maxScore);
  
  // 類似度を計算（百分率）
  const percentage = (1 - scoreR / maxScoreR) * 100;

  return { name: lab.name, score: parseFloat(percentage.toFixed(2)), url: lab.url };
});

// 一致度の高い順にソート
results.sort((a, b) => b.score - a.score);

// 上位３つを返す
return results.slice(0, 3);
}

// 一致した研究室を表示する関数
function displayResults(results) {
const resultList = document.getElementById("resultList");
resultList.innerHTML = ""; // 前回の結果を削除
results.forEach(lab => {
  const div = document.createElement("div");
  div.classList.add("result-item");
  div.innerHTML = `
      <h3>${lab.name}</h3>
      <p>一致度: <span class="match">${lab.score}%</span></p>
      <p><a href="${lab.url}" target="_blank">研究室ホームページ</a></p>
  `;
  resultList.appendChild(div);
});

document.getElementById("result").classList.remove("hidden");
}


    </script>
</body>
</html>
